<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>D√©tective Conan ‚Äì L'Affaire du Ruban √âcarlate</title>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: #0d1117;
            color: #e6edf3;
            text-align: center;
            padding: 20px;
        }
        .scene, .dialogue, .choices, .clues, .result { display: none; }
        .active { display: block; }
        .btn {
            background-color: #1f6feb;
            color: #fff;
            border: none;
            padding: 12px 25px;
            margin: 8px;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.3s ease;
        }
        .btn:hover { background-color: #4a90e2; }
        .container {
            max-width: 700px;
            margin: 0 auto;
            background: #161b22;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }
        .image {
            width: 150px;
            height: 150px;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .celebration {
            background-color: #FFD700;
            color: #333;
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
        }
        .puzzle {
            margin-top: 20px;
            padding: 15px;
            background-color: #1a1f2b;
            border-radius: 10px;
        }
        input[type="text"] {
            padding: 10px;
            margin-top: 10px;
            width: 80%;
            border-radius: 8px;
            border: none;
        }
        .hint { display: none; color: #aaa; font-style: italic; }
        audio { margin-top: 15px; }
        .testimony img {
            max-width: 150px;
            border-radius: 8px;
            margin: 10px auto;
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ D√©tective Conan ‚Äì Enqu√™te d'anniversaire</h1>

        <div id="mainMenu" class="scene active">
            <p>Bienvenue jeune d√©tective. Une mission secr√®te t'attend aujourd‚Äôhui pour c√©l√©brer un anniversaire bien particulier. Pr√©pare-toi √† r√©soudre plusieurs √©nigmes‚Ä¶</p>
            <button class="btn" onclick="startPuzzles()">Commencer l‚Äôenqu√™te</button>
            <audio controls loop>
                <source src="theme-conan.mp3" type="audio/mpeg" />
                Votre navigateur ne supporte pas l'audio HTML5.
            </audio>
        </div>

        <!-- Puzzle 1 -->
        <div id="puzzle1" class="scene puzzle">
            <h2>üîé √ânigme 1 ‚Äì Message Chiffr√©</h2>
            <p>"Uifsf jt b tfdsfu nfttbhf ijeefo cz uif dboemfmjhiu"</p>
            <button class="btn" onclick="toggleHint('hint1')">Afficher l‚Äôindice</button>
            <p id="hint1" class="hint">Indice : Chaque lettre a √©t√© d√©cal√©e d‚Äôun cran dans l‚Äôalphabet (code de C√©sar +1).</p>
            <input type="text" id="answer1" autocomplete="off" /><br />
            <button class="btn" onclick="checkAnswer(1, 'there is a secret message hidden by the candlelight')">Valider</button>
            <p id="error1" style="color:#f44336;"></p>
        </div>

        <!-- Puzzle 2 -->
        <div id="puzzle2" class="scene puzzle">
            <h2>üîé √ânigme 2 ‚Äì Moment mythique de Conan</h2>
            <p>Dans quel lieu embl√©matique Conan redevient temporairement Shinichi pour la premi√®re fois ?</p>
            <button class="btn" onclick="toggleHint('hint2')">Afficher l‚Äôindice</button>
            <p id="hint2" class="hint">Indice : Un endroit romantique sous la pluie √† Tokyo. La...</p>
            <input type="text" id="answer2" autocomplete="off" /><br />
            <button class="btn" onclick="checkAnswer(2, 'tour de tokyo')">Valider</button>
            <p id="error2" style="color:#f44336;"></p>
        </div>

        <!-- Puzzle 3 -->
        <div id="puzzle3" class="scene puzzle">
            <h2>üîé √ânigme 3 ‚Äì Leur rencontre</h2>
            <p>Souviens-toi de nos d√©buts sur le serveur Discord...<br />Tu as r√©pondu... ?</p>
            <input type="text" id="answer3" autocomplete="off" /><br />
            <button class="btn" onclick="checkAnswer(3, 'yes ?')">Valider</button>
            <p id="error3" style="color:#f44336;"></p>
        </div>

        <!-- Puzzle 4 -->
        <div id="puzzle4" class="scene puzzle">
            <h2>üîé √ânigme 4 ‚Äì Devinette</h2>
            <p>Plus tu en as, moins tu vois.<br />Invisible, silencieux, je t‚Äôenveloppe sans bruit.<br />Qui suis-je ?</p>
            <input type="text" id="answer4" autocomplete="off" /><br />
            <button class="btn" onclick="checkAnswer(4, 'le brouillard')">Valider</button>
            <p id="error4" style="color:#f44336;"></p>
        </div>

        <!-- Final message -->
        <div id="finalMessage" class="scene">
            <div class="celebration">
                <img src="gateau.jpg" class="image" alt="G√¢teau d'anniversaire" />
                <p>üéâ Joyeux anniversaire, d√©tective en herbe ! üéâ<br />
                    Aujourd‚Äôhui, je voulais marquer ce jour d‚Äôune touche de myst√®re, comme tu les aimes. Merci pour ta bienveillance, ton humour et ta pr√©sence. Longue vie, d√©tective pr√©f√©r√©. üïµÔ∏è‚Äç‚ôÇÔ∏è‚ù§Ô∏è
                </p>
                <button class="btn" onclick="startFinalGame()">üî¥ Lancer l'Affaire du Ruban √âcarlate</button>
            </div>
        </div>

        <!-- Final Game -->
        <div id="finalGame" class="scene puzzle">
            <h2>üïµÔ∏è‚Äç‚ôÇÔ∏è Affaire du Ruban √âcarlate</h2>
            <p>Un meurtre a eu lieu lors d'une f√™te. Quatre suspects. Un seul coupable. Tu n'as droit qu'√† deux essais pour accuser. Interroge-les d'abord !</p>
            <p><strong>Les suspects :</strong></p>
            <button class="btn" onclick="showTestimony('alice')">Interroger Alice</button>
            <button class="btn" onclick="showTestimony('marc')">Interroger Marc</button>
            <button class="btn" onclick="showTestimony('julie')">Interroger Julie</button>
            <button class="btn" onclick="showTestimony('carla')">Interroger Carla</button>

            <div id="testimony" class="testimony">
                <img id="suspectImg" src="" alt="Photo du suspect" />
                <p id="testimonyText"></p>
            </div>

            <p><strong>Indice g√©n√©ral :</strong><br />
                Le ruban √©carlate du costume du coupable a √©t√© retrouv√© tach√© de vin rouge. Mais‚Ä¶ personne n‚Äôen portait officiellement.
            </p>

            <input type="text" id="finalAnswer" placeholder="Nom du coupable" autocomplete="off" /><br />
            <button class="btn" onclick="checkFinal()">Accuser</button>
            <p id="finalError" style="color:#f44336;"></p>
        </div>
    </div>

<script>
    // Fonction toggle pour les indices
    function toggleHint(id) {
        const hint = document.getElementById(id);
        if (hint.style.display === 'block') {
            hint.style.display = 'none';
        } else {
            hint.style.display = 'block';
        }
    }

    // Gestion des r√©ponses aux puzzles
    function checkAnswer(num, correctAnswer) {
        const input = document.getElementById('answer' + num);
        const error = document.getElementById('error' + num);
        const userAnswer = input.value.trim().toLowerCase();

        if (userAnswer === correctAnswer.toLowerCase()) {
            error.style.color = 'lightgreen';
            error.textContent = "‚úÖ Bonne r√©ponse !";

            // Passer √† la sc√®ne suivante ou afficher finalMessage si dernier puzzle
            if (num < 4) {
                setTimeout(() => {
                    showScene('puzzle' + (num + 1));
                    error.textContent = "";
                    input.value = "";
                }, 1000);
            } else {
                setTimeout(() => {
                    showScene('finalMessage');
                    error.textContent = "";
                    input.value = "";
                }, 1500);
            }
        } else {
            error.style.color = '#f44336';
            error.textContent = "‚ùå Mauvaise r√©ponse, essaie encore.";
        }
    }

    // Fonction pour afficher une sc√®ne
    function showScene(id) {
        document.querySelectorAll('.scene').forEach(scene => {
            scene.classList.remove('active');
        });
        document.getElementById(id).classList.add('active');
    }

    // Lancer les puzzles depuis le menu principal
    function startPuzzles() {
        showScene('puzzle1');
    }

    // D√©marrer le jeu final
    function startFinalGame() {
        showScene('finalGame');
    }

    // Photos des suspects
    const suspectPhotos = {
        "alice": "alice.jpg",
        "marc": "marc.jpg",
        "julie": "julie.jpg",
        "carla": "carla.jpg"
    };

    // T√©moignages des suspects
    const testimonies = {
        "alice": "J‚Äô√©tais pr√®s de la baie vitr√©e. J‚Äôai vu quelqu‚Äôun pr√®s du buffet changer rapidement de v√™tement. Mais je ne peux pas dire qui, c‚Äô√©tait trop confus, la lumi√®re √©tait faible.",
        "marc": "Je servais les boissons et j‚Äôai remarqu√© que Julie semblait distraite. Elle a parl√© d‚Äôune absence br√®ve, mais elle n‚Äôa jamais dit o√π elle √©tait vraiment.",
        "julie": "Pendant que je g√©rais la musique, j‚Äôai vu Carla sortir pr√©cipitamment de la salle. Elle portait sa robe habituelle, mais apr√®s un moment, elle est revenue avec une √©charpe rouge diff√©rente, ce qui m‚Äôa paru √©trange.",
        "carla": "Je suis partie me changer, mais ce n‚Äô√©tait pas pour longtemps. J‚Äôai entendu des rumeurs sur quelqu‚Äôun qui aurait renvers√© du vin pr√®s du buffet, √ßa m‚Äôa un peu inqui√©t√©e‚Ä¶"
    };

    // Afficher t√©moignage d‚Äôun suspect
    function showTestimony(suspect) {
        const img = document.getElementById('suspectImg');
        const text = document.getElementById('testimonyText');

        img.src = suspectPhotos[suspect] || "";
        img.alt = `Photo de ${suspect.charAt(0).toUpperCase() + suspect.slice(1)}`;
        text.textContent = testimonies[suspect];
    }

    let attempts = 0;
    function checkFinal() {
        const answerInput = document.getElementById('finalAnswer');
        const answer = answerInput.value.trim().toLowerCase();
        const error = document.getElementById('finalError');
        attempts++;

        if (answer === 'carla') {
            alert("Bravo d√©tective ! C'√©tait bien Carla. Son changement de tenue suspect et l‚Äô√©charpe rouge tach√©e de vin ont trahi sa culpabilit√©. Tu as r√©solu l'affaire ! üéâ");
            // Reset
            attempts = 0;
            answerInput.value = "";
            error.textContent = "";
            document.getElementById('testimonyText').textContent = "";
            document.getElementById('suspectImg').src = "";
            showScene('mainMenu');
        } else {
            if (attempts >= 2) {
                error.textContent = "‚ùå Deux tentatives... Affaire non r√©solue. R√©essaie depuis le d√©but si tu veux te rattraper.";
                // Optionnel : reset essais et revenir au menu
                setTimeout(() => {
                    attempts = 0;
                    error.textContent = "";
                    answerInput.value = "";
                    document.getElementById('testimonyText').textContent = "";
                    document.getElementById('suspectImg').src = "";
                    showScene('mainMenu');
                }, 3000);
            } else {
                error.textContent = "Ce n'est pas le bon suspect. Il te reste une tentative.";
            }
        }
    }
</script>

</body>
</html>
